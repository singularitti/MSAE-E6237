% !TEX root = report.tex

\subsubsection{\texttt{UPDG} subroutine}

This part is used to update several quantities of cell during calculations.

% Table generated by Excel2LaTeX from sheet 'Sheet2'
\begin{table}[htbp]
	\centering
	\caption{List of some variables in \texttt{UPDG} subroutine.}
	\begin{tabular}{@{}llr@{}}
		\toprule
		variable name           & variable symbol                                 & variable       \\
		\midrule
		lattice vectors matrix  & $h$                                             & \texttt{avec}  \\
		lattice velocity vector & $\dot{h}$                                       & \texttt{avecd} \\
		metric tensor           & $g = h \tran h$                                 & \texttt{g}     \\
		metric tensor velocity  & $\dot{g} = \dot{ h }\tran h + h \dot{ h }\tran$ & \texttt{gd}    \\
		metric tensor inverse   & $g^{-1}$                                        & \texttt{gm1}   \\
		                        & $g^{-1} \dot{g}$                                & \texttt{gmgd}  \\
		\bottomrule
	\end{tabular}%
	\label{tab:updg}%
\end{table}%


It first reads a flag \texttt{itg} to see if $\sigma$ and $V$ need to be calculated,
if it is `yes', then do the following things:
Firstly calculates $\sigma$ by the components of $h$, and then calculate the
MD cell volume by
\begin{equation}
	V = \sigma \cdot h,
\end{equation}
and then calculate $g$, $\dot{ g }$, $g^{-1}$, $g^{-1}\dot{g}$, respectively.
